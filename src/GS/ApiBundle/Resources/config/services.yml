services:
#    gsapi.example:
#        class: GS\ApiBundle\Example
#        arguments: ["@service_id", "plain_value", "%parameter%"]

    gsapi.menu.builder:
        class: GS\ApiBundle\Menu\Builder
        arguments: [ '@knp_menu.factory', '@doctrine.orm.entity_manager' ]
        tags:
            - { name: knp_menu.menu_builder, method: mainMenu, alias: mainMenu }
            - { name: knp_menu.menu_builder, method: organizerMenu, alias: organizerMenu }
            - { name: knp_menu.menu_builder, method: treasurerMenu, alias: treasurerMenu }
            - { name: knp_menu.menu_builder, method: secretaryMenu, alias: secretaryMenu }
            - { name: knp_menu.menu_builder, method: adminMenu, alias: adminMenu }

    gsapi.profiler.admin.matcher:
        class: GS\ApiBundle\Profiler\AdminMatcher
        arguments: ['@security.authorization_checker']
        public: false

    gsapi.form.user.registration:
        class: GS\ApiBundle\Form\Type\UserRegistrationType
        tags:
            - { name: form.type, alias: gsapi_user_registration }

    gsapi.form.user.profile:
        class: GS\ApiBundle\Form\Type\UserProfileType
        tags:
            - { name: form.type, alias: gsapi_user_profile }

    jms_serializer.handler.relation:
        class: GS\ApiBundle\Serializer\RelationsHandler
        arguments:
            - "@doctrine.orm.entity_manager"
        tags:
            - { name: jms_serializer.handler, type: Relation, direction: serialization, format: json, method: serializeRelation}
            - { name: jms_serializer.handler, type: Relation, direction: deserialization, format: json, method: deserializeRelation}
            - { name: jms_serializer.handler, type: Relation<?>, direction: serialization, format: json, method: serializeRelation}
            - { name: jms_serializer.handler, type: Relation<?>, direction: deserialization, format: json, method: deserializeRelation}

    # It is an event subscriber, not an event listener! To be corrected to avoid confusion
    gsapi.user.listener:
        class: GS\ApiBundle\EventListener\UserListener
        arguments:
            - "@doctrine.orm.entity_manager"
            - "@router"
        tags:
            - { name: kernel.event_subscriber }

    gsapi.account_balance:
        class: GS\ApiBundle\Services\AccountBalanceService
        arguments: [ '@doctrine.orm.entity_manager' ]

    gsapi.account_voter:
        class: GS\ApiBundle\Security\AccountVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.certificate_voter:
        class: GS\ApiBundle\Security\CertificateVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.venue_voter:
        class: GS\ApiBundle\Security\VenueVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.registration_voter:
        class: GS\ApiBundle\Security\RegistrationVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.year_voter:
        class: GS\ApiBundle\Security\YearVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.activity_voter:
        class: GS\ApiBundle\Security\ActivityVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.topic_voter:
        class: GS\ApiBundle\Security\TopicVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.category_discount_voter:
        class: GS\ApiBundle\Security\CategoryDiscountVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.payment_voter:
        class: GS\ApiBundle\Security\PaymentVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.invoice_voter:
        class: GS\ApiBundle\Security\InvoiceVoter
        arguments: ['@security.access.decision_manager']
        public: false
        tags:
            - { name: security.voter }

    gsapi.user.repository:
            class: Doctrine\ORM\EntityRepository
            factory: ["@doctrine.orm.entity_manager", getRepository]
            arguments:
                - GS\ApiBundle\Entity\User

    gsapi.event.table_prefix_subscriber:
        class: GS\ApiBundle\EventSubscriber\TablePrefixSubscriber
        public: false
        arguments: ['']
        tags:
            - { name: doctrine.event_subscriber }

    gsapi.user.membership:
        class: GS\ApiBundle\Services\MembershipService
        arguments: [ '@doctrine.orm.entity_manager' ]

    gsapi.registration.service:
        class: GS\ApiBundle\Services\RegistrationService
        arguments: [ '@doctrine.orm.entity_manager', '@mailer', '@lexik_mailer.message_factory' ]

    gsapi.payment.service:
        class: GS\ApiBundle\Services\PaymentService
        arguments: [ '@mailer', '@lexik_mailer.message_factory' ]
